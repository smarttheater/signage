webpackJsonp([2],{"5zde":function(t,e,a){a("zQR9"),a("qyJz"),t.exports=a("FeBl").Array.from},Gu7T:function(t,e,a){"use strict";e.__esModule=!0;var r,n=a("c/Tr"),s=(r=n)&&r.__esModule?r:{default:r};e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,s.default)(t)}},PdC8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("pFYg"),u=a.n(s),i=a("Gu7T"),c=a.n(i),o=a("exGp"),l=a.n(o),h=a("//Fk"),f=a.n(h),m=a("PJh5"),d=a("msXN");a("ORgI"),m.locale("ja");var v={data:function(){return{langArray:["ja","en","zh-hans"],currentLangIndex:0,locale:{tourNumber:{ja:"ツアーNo",en:"Tour No.","zh-hans":"游览编号"},entranceTime:{ja:"入場受付時間",en:"Entrance Time","zh-hans":"入场受理时间"},availability:{ja:"空き状況",en:"Availability","zh-hans":"可预约情况"}},ticketinfoArray:[{ticket_id:"001",price:2800,ja:{name:"大人",cap:"高校生以上"},en:{name:"Adult",cap:"16 years or over"},"zh-hans":{name:"成人",cap:"16岁以上"}},{ticket_id:"002",price:1800,ja:{name:"子供",cap:"小・中学生"},en:{name:"Junior",cap:"7 to 15 years"},"zh-hans":{name:"儿童",cap:"7～15岁"}},{ticket_id:"003",price:1200,ja:{name:"幼児",cap:"4歳以上"},en:{name:"Child",cap:"4 to 6 years"},"zh-hans":{name:"幼儿",cap:"4～6岁"}}],nearStatusArray:[],futureAvgStatusArray:[],timeoutInstance_changeLang:null,timeoutInstance_IntervalFetch:null}},computed:{currentLang:function(){return this.langArray[this.currentLangIndex]}},methods:{fetchScheduleStatus:d.a,getNextTickUnixtime:d.b,getStatusClassNameByPerformance:d.c,manipulateScheduleData:d.d,echoPrice:function(t){return"￥"+t.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},updateStatus:function(){var t,e=this;return new f.a((t=l()(n.a.mark(function t(a,r){var s,i,o,l,h,f,d;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=m().minute(0).second(0),t.next=4,e.fetchScheduleStatus({startFrom:s.toISOString(),startThrough:s.add(4,"hour").minute(59).second(59).toISOString()});case 4:i=t.sent,o=m().hour(),l=[],h=[],f={},e.manipulateScheduleData(i).forEach(function(t){try{if(m().isAfter(m(t.endDate)))return!0;-1===h.indexOf(t.hour)&&(h.push(t.hour),f[t.hour]=[]),f[t.hour].push(t),l.length<4&&l.push(t)}catch(t){return console.log(t),!0}return!0}),e.nearStatusArray=l,d=[].concat(c()(Array(4))).map(function(t,e){return e+1+o}),e.futureAvgStatusArray=d.filter(function(t){return"object"===u()(f[t])}).map(function(t){var e=!0,a=Math.floor(f[t].reduce(function(t,a){if(!a.unavailable){e=!1;var r=parseInt(a.seat_status,10);return isNaN(r)&&(r=0),t+r}return t},0)/f[t].length);return{hours:t+":00～"+("0"+(parseInt(t,10)+1)).slice(1)+":00",seat_status:a,unavailable:e,is_avg:!0}}),t.next=18;break;case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",r(t.t0));case 18:return t.abrupt("return",a());case 19:case"end":return t.stop()}},t,e,[[0,15]])})),function(e,a){return t.apply(this,arguments)}))},setFetchStatusDataTimeout:function(){var t=this;this.timeoutInstance_IntervalFetch=setTimeout(l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateStatus();case 2:t.setFetchStatusDataTimeout();case 3:case"end":return e.stop()}},e,t)})),this.getNextTickUnixtime())},setChangeLangTimeout:function(t){var e=this;this.timeoutInstance_changeLang=setTimeout(function(){e.currentLangIndex++,e.currentLangIndex>e.langArray.length-1?(e.currentLangIndex=0,e.setChangeLangTimeout(6e3)):e.setChangeLangTimeout()},t||3e3)}},created:function(){var t=this;this.$store.commit("SET_LOADINGMSG","最新の情報を取得中..."),this.updateStatus().then(function(){t.$store.commit("CLEAR_LOADINGMSG"),t.setFetchStatusDataTimeout(),t.setChangeLangTimeout(6e3)})},beforeDestroy:function(){clearTimeout(this.timeoutInstance_IntervalFetch),clearTimeout(this.timeoutInstance_changeLang)}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["container","container-ticketstatus","lang-"+t.currentLang,{onerror:t.$store.state.errorMsgStr}]},[t.$store.state.errorMsgStr?a("errorOneline",{attrs:{errorMsgStr:"通信エラーが発生しています "+t.$store.state.errorMsgStr}}):t._e(),t._v(" "),a("div",{staticClass:"area area-info"},[t._m(0),t._v(" "),a("div",{staticClass:"prices"},t._l(t.ticketinfoArray,function(e){return a("section",{key:e.ticket_id},[a("div",[a("h2",[t._v(t._s(e[t.currentLang].name)),a("span",[t._v("("+t._s(e[t.currentLang].cap)+")")])]),t._v(" "),a("p",[t._v(t._s(t.echoPrice(e.price)))])])])}))]),t._v(" "),a("div",{staticClass:"area area-schedule"},[t._m(1),t._v(" "),a("table",{staticClass:"table-main"},[a("thead",[a("tr",[a("th",[t._v(t._s(t.locale.tourNumber[t.currentLang]))]),t._v(" "),a("th",{staticClass:"time"},[t._v(t._s(t.locale.entranceTime[t.currentLang]))]),t._v(" "),a("th",[t._v(t._s(t.locale.availability[t.currentLang]))])])]),t._v(" "),a("tbody",t._l(t.nearStatusArray,function(e){return a("tr",{key:e.id,class:["item",t.getStatusClassNameByPerformance(t.$store.state.moment,e,10)]},[a("td",[t._v(t._s(e.tour_number))]),t._v(" "),a("td",{staticClass:"time"},[t._v(t._s(e.start_time)+" ～ "+t._s(e.end_time))]),t._v(" "),a("td",{staticClass:"wrapper-status"},[a("span",{staticClass:"status"},[t._v(t._s(e.seat_status))])])])})),t._v(" "),a("tfoot",[a("tr",[a("td",{attrs:{colspan:"3"}},t._l(t.futureAvgStatusArray,function(e,r){return a("div",{key:r,class:["houritem",t.getStatusClassNameByPerformance(t.$store.state.moment,e)]},[a("p",{staticClass:"hours"},[t._v(t._s(e.hours))]),t._v(" "),a("div",{staticClass:"wrapper-status"},[a("p",{staticClass:"status"},[t._v(t._s(e.seat_status))])])])}))])])])],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mainvisual"},[e("p",[e("shine-icon")],1)])},function(){var t=this.$createElement;return(this._self._c||t)("clock",{staticClass:"iconBefore icon-clock"})}]};var p=a("VU/8")(v,_,!1,function(t){a("Wlt4")},null,null);e.default=p.exports},Wlt4:function(t,e){},"c/Tr":function(t,e,a){t.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(t,e,a){"use strict";var r=a("evD5"),n=a("X8DO");t.exports=function(t,e,a){e in t?r.f(t,e,n(0,a)):t[e]=a}},qyJz:function(t,e,a){"use strict";var r=a("+ZMJ"),n=a("kM2E"),s=a("sB3e"),u=a("msXi"),i=a("Mhyx"),c=a("QRG4"),o=a("fBQ2"),l=a("3fs2");n(n.S+n.F*!a("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,n,h,f=s(t),m="function"==typeof this?this:Array,d=arguments.length,v=d>1?arguments[1]:void 0,_=void 0!==v,p=0,g=l(f);if(_&&(v=r(v,d>2?arguments[2]:void 0,2)),void 0==g||m==Array&&i(g))for(a=new m(e=c(f.length));e>p;p++)o(a,p,_?v(f[p],p):f[p]);else for(h=g.call(f),a=new m;!(n=h.next()).done;p++)o(a,p,_?u(h,v,[n.value,p],!0):n.value);return a.length=p,a}})}});